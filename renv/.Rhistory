library(pathways)
library(pathways)
x<-readxl::read_xlsx(system.file("data", "Col-top50.xlsx", package = "pathways"))
y<-readxl::read_xlsx(system.file("data", "metadata.xlsx", package = "pathways"))
CTSgetR::CTSgetR(y$Sample,"PubChem CID", "KEGG")%>%na.omit()->getkeggnames
full_join(getkeggnames,y,by=c("id"="Sample"),keep=T)->getkegg
getkegg$Sample[!is.na(getkegg$KEGG)]<-getkegg$KEGG[!is.na(getkegg$KEGG)]
getkegg$Sample[!is.na(getkegg$KEGG)]<-getkegg$KEGG[!is.na(getkegg$KEGG)]
getkegg%>%.[,-c(1:2)]%>%na.omit()->data
data[rev(order(data$Sample)),]->data2
rownames(data2)<-data2$Sample
data2[,-1]->data2
library(biomaRt)
mart <- useMart("ensembl","mmusculus_gene_ensembl")
gene_name<-getBM(attributes=c("ensembl_gene_id","entrezgene_id"),
filters = "ensembl_gene_id",values = x$Gene, mart = mart)
full_join(gene_name,x,by=c("ensembl_gene_id"="Gene"))->getkegg
getkegg$ensembl_gene_id[!is.na(getkegg$entrezgene_id)]<-getkegg$entrezgene_id[!is.na(getkegg$entrezgene_id)]
getkegg[,-2]->genes
rownames(genes)<-genes$ensembl_gene_id
genes[,-1]->genes
group<-c(rep("A",4),rep("B",5))
colnames(data2)<-colnames(genes)
list(a=data2%>%t%>%as.data.frame(),b=genes%>%t%>%as.data.frame())->data
pathways_analy(data = data,group = group,org = "mmu",scale = T)->n
library(dplyr)
full_join(getkeggnames,y,by=c("id"="Sample"),keep=T)->getkegg
getkegg$Sample[!is.na(getkegg$KEGG)]<-getkegg$KEGG[!is.na(getkegg$KEGG)]
getkegg$Sample[!is.na(getkegg$KEGG)]<-getkegg$KEGG[!is.na(getkegg$KEGG)]
getkegg%>%.[,-c(1:2)]%>%na.omit()->data
data[rev(order(data$Sample)),]->data2
rownames(data2)<-data2$Sample
data2[,-1]->data2
library(biomaRt)
gene_name<-getBM(attributes=c("ensembl_gene_id","entrezgene_id"),
filters = "ensembl_gene_id",values = x$Gene, mart = mart)
full_join(gene_name,x,by=c("ensembl_gene_id"="Gene"))->getkegg
getkegg$ensembl_gene_id[!is.na(getkegg$entrezgene_id)]<-getkegg$entrezgene_id[!is.na(getkegg$entrezgene_id)]
getkegg[,-2]->genes
rownames(genes)<-genes$ensembl_gene_id
genes[,-1]->genes
group<-c(rep("A",4),rep("B",5))
colnames(data2)<-colnames(genes)
list(a=data2%>%t%>%as.data.frame(),b=genes%>%t%>%as.data.frame())->data
pathways_analy(data = data,group = group,org = "mmu",scale = T)->n
